# - binary_sensor:
#     - name: Occupancy K
#       device_class: occupancy
#       state: >-
#         {{ is_state('binary_sensor.0x158d0002b4729d_motion', 'on') or 
#         is_state('binary_sensor.0x158d0002b48381_motion', 'on') or 
#         is_state('binary_sensor.50ec50cd0062_motion','on') or
#         is_state('sensor.0x158d0002a2412d_action','vibration') or
#         is_state('sensor.0x158d0002a2412d_action', 'tilt') or
#         is_state('binary_sensor.0x158d000423f316_contact','off') or
#         is_state('sensor.0x158d0002a36f7f_action','button_2_single') or
#         is_state('sensor.0x158d0002a36f7f_action','button_1_single') or
#         is_state('binary_sensor.esp8266_hood_k_light_button','on') or
#         is_state('binary_sensor.esp8266_hood_k_fan_button','on') or
#         is_state('binary_sensor.sonoff_mini_4_sw','on') or
#         is_state('binary_sensor.d1mini_light_l_button','on') or
#         is_state('sensor.yandex_lite_k_alice_state','listening') }}
#       delay_off:
#         minutes: 3

- trigger:
    - platform: state
      entity_id:
        #- binary_sensor.0x158d0001e54280_motion
        - binary_sensor.0x158d00025371f6_contact
        - binary_sensor.0x158d0002a1a47a_contact
      from: "on"
      to: "off"
    - platform: state
      entity_id:
        - binary_sensor.0x158d0002b4729d_motion
        - binary_sensor.0x158d0002b48381_motion
        - binary_sensor.50ec50cd0062_motion
        - binary_sensor.0x158d000423f316_contact
        - binary_sensor.esp8266_hood_k_light_button
        - binary_sensor.esp8266_hood_k_fan_button
        - binary_sensor.sonoff_mini_4_sw
        - binary_sensor.d1mini_light_l_button
        - binary_sensor.0x158d00025371f6_contact
        - binary_sensor.0x158d0002a1a47a_contact
      from: "off"
      to: "on"
    - platform: state
      entity_id: sensor.0x158d0002a36f7f_action
      to:
        - button_1_single
        - button_2_single
    - platform: state
      entity_id: sensor.0x158d0002a2412d_action
      to:
        - tilt
        - vibration
  binary_sensor:
    - name: Occupancy K
      state: "{{ true }}"
      device_class: occupancy
      auto_off:
        minutes: 3


- trigger:
    - platform: state
      entity_id:
        #- binary_sensor.0x158d0001e54280_motion
        - binary_sensor.0x158d0001ef2ffc_contact
        - binary_sensor.0x158d000232ddd6_contact
        - binary_sensor.0x158d0003262a35_contact
      from: "on"
      to: "off"
    - platform: state
      entity_id:
        - binary_sensor.0x158d0001e54280_motion
        - binary_sensor.0x158d0001ef2ffc_contact
        - binary_sensor.0x158d000232ddd6_contact
        - binary_sensor.0x158d0003262a35_contact
      from: "off"
      to: "on"
    - platform: state
      entity_id:
        - sensor.0x158d0001b97111_action
      to:
        - single
        - double
        - hold
  binary_sensor:
    - name: Occupancy T
      state: "{{ true }}"
      device_class: occupancy
      auto_off:
        minutes: 3

- trigger:
    - platform: state
      entity_id:
        #- binary_sensor.0x158d000236bc6d_motion
        - binary_sensor.0x158d0002a14c5e_contact
        - binary_sensor.0x158d0003fa6cf5_contact
      from: "on"
      to: "off"
    - platform: state
      entity_id:
        - binary_sensor.0x158d000236bc6d_motion
        - binary_sensor.0x158d0002a14c5e_contact
        - binary_sensor.0x158d0003fa6cf5_contact
      from: "off"
      to: "on"
    - platform: state
      entity_id:
        - sensor.0x158d0001b94abe_action
        - sensor.0x158d0001ef6089_action
      to:
        - single
        - double
        - hold
  binary_sensor:
    - name: Occupancy B
      state: "{{ true }}"
      device_class: occupancy
      auto_off:
        minutes: 3

      # icon: >
      #   {% if is_state('binary_sensor.motion_k','on') %}
      #   mdi:run
      #   {% else %}
      #   mdi:walk
      #   {% endif %}
